import React,{useState} from 'react';import { API_BASE } from '../config'
export function FriendsInvite({onBooked}){const [ownerEmail,setOwnerEmail]=useState('owner@example.com');const [friendEmail,setFriendEmail]=useState('friend@example.com');const [petName,setPetName]=useState('H');const [startDate,setStartDate]=useState(new Date().toISOString().slice(0,10));const [endDate,setEndDate]=useState(new Date(Date.now()+6*24*3600*1000).toISOString().slice(0,10));const [ratePerDay,setRatePerDay]=useState(1500);const [insuranceAddon,setInsuranceAddon]=useState(1000);const [inviteId,setInviteId]=useState(null);const [summary,setSummary]=useState(null);async function createInvite(){const r=await fetch(`${API_BASE}/friends/invite`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ownerEmail,friendEmail,petName,startDate,endDate,ratePerDay,insuranceAddon})});const j=await r.json();setInviteId(j.inviteId);setSummary(j.summary)}async function acceptInvite(){const r=await fetch(`${API_BASE}/friends/accept`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({inviteId})});const j=await r.json();onBooked(j.bookingId)}return(<div className='mt-6 p-5 bg-white rounded shadow-card'><h2 className='text-2xl font-semibold mb-4'>Invite a Friend</h2><div className='grid md:grid-cols-2 gap-4'><label className='block'><span className='text-sm text-slate-600'>Your e‑mail</span><input className='w-full border rounded px-3 py-2' value={ownerEmail} onChange={e=>setOwnerEmail(e.target.value)}/></label><label className='block'><span className='text-sm text-slate-600'>Friend e‑mail</span><input className='w-full border rounded px-3 py-2' value={friendEmail} onChange={e=>setFriendEmail(e.target.value)}/></label><label className='block'><span className='text-sm text-slate-600'>Pet name</span><input className='w-full border rounded px-3 py-2' value={petName} onChange={e=>setPetName(e.target.value)}/></label><label className='block'><span className='text-sm text-slate-600'>Rate per day (pence)</span><input type='number' className='w-full border rounded px-3 py-2' value={ratePerDay} onChange={e=>setRatePerDay(Number(e.target.value))}/></label><label className='block'><span className='text-sm text-slate-600'>Start date</span><input type='date' className='w-full border rounded px-3 py-2' value={startDate} onChange={e=>setStartDate(e.target.value)}/></label><label className='block'><span className='text-sm text-slate-600'>End date</span><input type='date' className='w-full border rounded px-3 py-2' value={endDate} onChange={e=>setEndDate(e.target.value)}/></label><label className='flex items-center gap-2'><input type='checkbox' checked={!!insuranceAddon} onChange={e=>setInsuranceAddon(e.target.checked?1000:0)}/><span>Add insurance (+£10)</span></label></div>{!inviteId?(<button className='mt-4 px-4 py-2 bg-emerald-600 text-white rounded' onClick={createInvite}>Create Invite</button>):(<div className='mt-4'><p className='text-slate-700'>Invite created. Total: £{((summary?.total||0)/100).toFixed(2)}</p><button className='mt-2 px-4 py-2 bg-sky-600 text-white rounded' onClick={acceptInvite}>Simulate Friend Accept</button></div>)}</div>)}
