import { repo } from './repo.js';import { isoNow } from './utils.js';
export default async function agreementsRoutes(app){app.get('/sitters/:id/agreements',async(req,reply)=>{const {id}=req.params;const list=await repo.getSitterAgreements(id);if(!list||list.length===0)return{agreements:[{id:'a1',sitterId:id,type:'PRO_CODE',url:'/docs/pro_code.pdf',hash:'9fâ€¦e1',signedAt:isoNow(),version:'1.0-2025-10-04'}]};return{agreements:list}});
app.post('/agreements/sign',async(req,reply)=>{const {sitterId,type,url,hash,version}=req.body||{};if(!sitterId||!type||!url||!hash)return reply.code(400).send({error:'Missing'});const saved=await repo.addSitterAgreement({sitterId,type,url,hash,version:version||'1.0-2025-10-04',signedAt:new Date().toISOString()});return{ok:true,agreement:saved}})}
